function isFunction(e){return e instanceof Function}function isArray(e){return e instanceof Array}function isObject(e){return e instanceof Object}function isElement(e){return e instanceof Element}function isText(e){return e instanceof Text}function isString(e){return"string"==typeof e}function Puzzle(e){function t(){var e=function(){for(var e=Math.random(3,6),t=[],n=0,i=0;i<e;i++)n+=Math.floor(Math.random(270/e,360/e)),t.push(125+75*Math.round(Math.cos(n*Math.PI/180))),t.push(150+75*Math.round(Math.sin(n*Math.PI/180)));return t}(),t=document.createElementNS("http://www.w3.org/2000/svg","polygon");t.classList.add("puzzle__frame"),t.setAttribute("points",e),o.canvas.appendChild(t);var n=function(e){for(var t=[],n=0;n<3;n++){var i,r=PolyK.GetAABB(e),o=r.x+r.width/2,s=r.y+r.height/2,a={},l={};i=n%2==0?Math.floor(Math.random(0,Math.PI/9*4)):Math.floor(Math.random(Math.PI/9*5,Math.PI/18*17)),a={x:r.x+r.width+10,y:Math.tan(i)*(r.x+10+r.width-o)+s},l={x:r.x-10,y:Math.tan(i)*(r.x-10-o)+s};var c=PolyK.Slice(e,a.x,a.y,l.x,l.y);2==c.length&&(t.push(c[0]),e=c[1])}return t.push(e),t}(e).sort(function(){return Math.random()-.5}),i={x:205,y:75,xMax:0};a=n.length;for(var l=0;l<n.length;l++){var c=PolyK.GetAABB(n[l]),u={x0:c.x,y0:c.y,id:l};c.height<230-i.y?(n[l]=PolyK.Move(n[l],i.x,i.y),u.x=i.x,u.y=i.y,i.y=i.y+c.height+5,c.width+i.x>i.xMax&&(i.xMax=c.width+i.x)):(i.y=80+c.height,i.x=i.xMax+5,i.xMax=i.x+c.width,n[l]=PolyK.Move(n[l],i.x,75),u.x=i.x,u.y=75),s.push(u);var d=document.createElementNS("http://www.w3.org/2000/svg","polygon");d.classList.add("puzzle__puzzle"),d.setAttribute("points",n[l]),d.setAttribute("index",l),d.addEventListener("mousedown",r),o.canvas.appendChild(d)}o.canvas.style.width=i.xMax+50+"px"}var n=function(e){var t=l.getAttribute("points").split(","),n=PolyK.GetAABB(t),i=o.canvas.getBoundingClientRect(),r=e.pageX-i.left,a=e.pageY-i.top,c=Number(l.getAttribute("index")),u=o.canvas.clientWidth;PolyK.ContainsPoint([0,0,u,0,u,300,0,300],n.x,n.y)&&PolyK.ContainsPoint([0,0,u,0,u,300,0,300],n.x+n.width,n.y+n.height)?(t=PolyK.Move(t,r-s[c].cursorX,a-s[c].cursorY),l.setAttribute("points",t)):document.body.dispatchEvent(new Event("mouseup"))}.bind(this),i=function(e){var u=Number(l.getAttribute("index")),d=l.getAttribute("points").split(","),h=PolyK.GetAABB(d);Math.abs(s[u].x0-h.x)<11&&Math.abs(s[u].y0-h.y)<11?(l.setAttribute("points",PolyK.Move(d,s[u].x0,s[u].y0)),l.removeEventListener("mousedown",r),0==--a&&(o.canvas.innerHTML="",s=[],c++,t())):l.setAttribute("points",PolyK.Move(l.getAttribute("points").split(","),s[u].x,s[u].y)),document.body.removeEventListener("mousemove",n),document.body.removeEventListener("mouseup",i),l=null}.bind(this),r=function(e){(l=e.target.cloneNode(!0)).addEventListener("mousedown",r),o.canvas.removeChild(e.target),o.canvas.appendChild(l);var t=PolyK.GetAABB(l.getAttribute("points").split(",")),a=o.canvas.getBoundingClientRect(),c=Number(l.getAttribute("index"));document.body.addEventListener("mousemove",n),document.body.addEventListener("mouseup",i),s[c].cursorX=e.pageX-a.left-t.x,s[c].cursorY=e.pageY-a.top-t.y}.bind(this);this.free=function(){document.body.dispatchEvent(new Event("mouseup"))},this.getScore=function(){return c};var o={canvas:null},s=[],a=0,l=null,c=0;o.canvas=document.createElementNS("http://www.w3.org/2000/svg","svg"),o.canvas.classList.add("puzzle__canvas"),e.appendChild(o.canvas),t()}function Ariphmetics(e){function t(){var e=function(){var e={a:null,operation:["+","-","/","*"][Math.floor(Math.random(0,3))],b:null,result:null};switch(e.operation){case"+":e.result=Math.floor(Math.random(1,99)),e.a=Math.floor(Math.random(1,e.result)),e.b=e.result-e.a;break;case"-":e.result=Math.floor(Math.random(1,70)),e.a=Math.floor(Math.random(e.result,99)),e.b=e.a-e.result;break;case"*":e.a=Math.floor(Math.random(2,49)),e.b=Math.floor(Math.random(2,100/e.a)),e.result=e.a*e.b;break;case"/":e.result=Math.floor(Math.random(2,49)),e.b=Math.floor(Math.random(2,100/e.result)),e.a=e.result*e.b}return e}(),r=function(e){for(var t=[],n=1;n<99;n++)n!=e&&t.push(n);return t.sort(function(){return Math.random()-.5}),t.slice(0,2)}(e.result),o=Math.floor(Math.random(0,r.length));r.splice(o,0,e.result),n.equotation.innerHTML=e.a+" "+e.operation+" "+e.b+" =";for(var s=0;s<r.length;s++){var a=n.answers.newChildElement("button",{classList:"ariphmetics__checkbox"});a.addEventListener("click",function(e){"RIGHT"==e.target.getAttribute("NAME")&&i++;n.answers.innerHTML="",n.equotation.innerHTML="",t()}.bind(this)),n.answers.newChildElement("span",{},""+r[s]),n.answers.newChildElement("br"),r[s]==e.result&&a.setAttribute("NAME","RIGHT")}}this.getScore=function(){return i};var n={container:null,equotation:null,answers:null},i=0;n.container=e.newChildElement("div",{classList:"ariphmetics__container"}),n.equotation=n.container.newChildElement("div",{classList:"ariphmetics__equotation"}),n.answers=n.container.newChildElement("div"),t()}function Concentration(e,t){function n(){(s.point||o)&&(s.point?(s.field.removeChild(s.point),s.point=null):o&&(o=!1),r=setTimeout(function(){r=null,s.point=s.field.newChildElement("div",{classList:"concentration__point"}),s.point.style.left=Math.floor(Math.random(5,565))+"px",s.point.style.top=Math.floor(Math.random(5,260))+"px"},Math.floor(Math.random(0,t/4))))}this.free=function(){null!=r&&(clearTimeout(r),document.body.removeEventListener("keyup",i))};var i=function(e){13!=e.which&&13!=e.keyCode||s.button.dispatchEvent(new Event("click"))}.bind(this),r=null,o=!0,s={container:null,button:null,field:null,point:null};s.container=e.newChildElement("div",{classList:"concentration__container"}),s.field=s.container.newChildElement("div",{classList:"concentration__field"}),n(),s.button=s.container.newChildElement("div",{classList:"concentration__button"}),s.button.innerText="<Enter>",s.button.addEventListener("click",n.bind(this)),document.body.addEventListener("keyup",i)}function Breaker(e){this.toggle=function(){n?t.container.removeCSS("breaker__container--hidden"):t.container.setCSS("breaker__container--hidden"),n=!n},this.setTime=function(e){t.time.innerHTML=e+"s"};var t={container:null,text:null,time:null},n=!0;t.container=e.newChildElement("div",{classList:["breaker__container","breaker__container--hidden"]}),t.text=t.container.newChildElement("span",{classList:"breaker__text"},"Отдыхайте:"),t.time=t.container.newChildElement("span",{classList:"breaker__time"})}function Score(e,t){var n={container:null,header:null,score:null};n.container=e.newChildElement("div",{classList:"score__container"}),n.header=n.container.newChildElement("span",{classList:"score__header"},"Результат:"),n.score=n.container.newChildElement("span",{classList:"score__result"},""+t)}function State(e,t){var n=function(){r++,o.free(),i.current.innerHTML="#"+t[r].name,i.next.disabled=!0,t[r].run(o,this)}.bind(this);this.continue=function(){r==t.length-1&&(i.next.innerHTML="Ещё раз",r=-1),i.next.disabled=!1};var i={container:null,current:null,next:null,frame:null},r=-1,o=new Test(document.body);t.splice(0,0,{name:"0",run:function(){o.add(0).newChildElement("button",{classList:["state__button","state__start"],eventListeners:{click:n.bind(this)}},"Начать тестирование")}.bind(this)}),i.container=e.newChildElement("div",{classList:"state__container"}),i.current=i.container.newChildElement("span",{classList:"state__name"},""),i.next=i.container.newChildElement("button",{classList:"state__button",eventListeners:{click:n.bind(this)}},"Следующий >"),n()}function Test(e){var t=function(){if(n){var e=r.container.rows[0].cells[i],t=(document.body.clientWidth-e.clientWidth)/2;r.container.getBoundingClientRect().left,e.getBoundingClientRect().left;r.container.style.left=t-e.offsetLeft+"px"}}.bind(this);this.deactivate=function(e){e=Number(e),r.container.rows[0].cells[e].appendChild(r.inactive.cloneNode(!0)),r.container.rows[0].cells[e].setCSS("test__inactive")},this.activate=function(e){i=Number(e),e=Number(e),t(),r.container.rows[0].cells[e].removeCSS("test__inactive");var n=r.container.rows[0].cells[e].getElementsByClassName("test__inactive_cover")[0];n&&r.container.rows[0].cells[e].removeChild(n)},this.add=function(e,t){var i=r.container.rows[0].insertCell(e);return i.setAttribute("index",e),i.setCSS("test__cell"),t&&(n=!1),i},this.free=function(){i=0,n=!0,r.container.style.left=null,r.container.rows[0].innerHTML=""};var n=!0,i=0,r={container:null,inactive:null};r.container=e.newChildElement("table",{classList:"test__container"},document.newElement("tr")),r.container.setEventListeners({resize:t}),r.inactive=document.newElement("div",{classList:"test__inactive_cover"})}function B3(e,t,n,i,r){var o=function(){i.activate(u),setTimeout(s,1e4)}.bind(this),s=function(){if(c.free(),++d>=6)return t&&document.body.removeChild(h),i.free(),new Score(i.add(0,!0),a.getScore()),new Score(i.add(1,!0),c.getScore()),void r.continue();i.deactivate(u),u=0==u?2:0,i.activate(1),l.toggle(),l.setTime(e),t&&h.play();var s=e,v=setInterval(function(){if(--s<=0)return null==t||n||h.play(),clearInterval(v),l.toggle(),i.deactivate(1),void o();t&&n&&(h.pause(),h.currentTime=0,h.play()),l.setTime(s)}.bind(this),1e3)}.bind(this),a=new Ariphmetics(i.add(0)),l=new Breaker(i.add(1)),c=new Puzzle(i.add(2)),u=0,d=0,h=null;t&&(h=document.body.newChildElement("audio",{SRC:t})),i.activate(0),i.deactivate(1),i.deactivate(2),setTimeout(s,1e4)}Element.prototype.setEventListeners=function(e){if(e&&isObject(e)){this.__events__=this.__events__||{};for(var t in e)isArray(e[t])||(e[t]=[e[t]]),this.__events__[t]=this.__events__[t]||[],e[t].forEach(function(e){if(isFunction(e)){if("resize"==t&&"IFRAME"!=this.tagName&&this.__events__.resize&&!this.__events__.resize.length)this.__resizer__=this.newChildElementBefore(this.children[0],"iframe",{style:"WIDTH:100%;HEIGHT:100%;POSITION:ABSOLUTE;OPACITY:0;Z-INDEX:-1000",name:"BASIS__RESIZER"}),this.__resizer__.contentWindow.onresize=function(){this.dispatchEvent(new Event("resize"))}.bind(this);else if("startloading"==t&&"IFRAME"==this.tagName&&this.__events__.startloading&&!this.__events__.startloading.length)var n=setInterval(function(){try{if("about:blank"==this.src)(e=new Event("startloading")).error="src",clearInterval(n),this.dispatchEvent(e);else if("about:blank"!=this.contentWindow.location.href){var e=new Event("startloading");clearInterval(n),this.dispatchEvent(e)}}catch(t){(e=new Event("startloading")).error="origin",clearInterval(n),this.dispatchEvent(e)}}.bind(this),10);this.__events__[t].push(e),this.addEventListener(t,e)}else console.warn('ERROR: cannot set something except Function as an event listener to event, called "'+t+'". Skipping.')}.bind(this))}else console.warn("ERROR: argument passed to setEventListeners method is not an Object. Skipping.")},Element.prototype.removeEventListeners=function(e){if(e&&isObject(e)){this.__events__=this.__events__||{};for(var t in e)isArray(e[t])||(e[t]=[e[t]]),this.__events__[t]=this.__events__[t]||[],e[t].forEach(function(e){if(isFunction(e)){var n=this.__events__[t].indexOf(e);-1!=n&&(this.__events__[t].splice(n,1),"startloading"!=t||this.__events__[t].length||this.removeChildren(this.__resizer__)),this.removeEventListener(t,e)}else console.warn('ERROR: cannot remove something except Function as an event listener to event, called "'+t+'". Skipping.')}.bind(this))}else console.warn("ERROR: argument passed to setEventListeners method is not an Object. Skipping.")},Element.prototype.cloneElement=function(e){var t;return e.deep,t=this.cloneNode(!0),e.listeners&&(t.__events__=this.__events__,t.setEventListeners(t.__events__)),t},Element.prototype.removeCSS=function(){Array.from(arguments).forEach(function(e){isString(e)?this.classList.remove(e):isArray(e)?this.setCSS.apply(this,e):console.warn("ERROR: cannot remove something except String as an CSS-class. Skipping.")}.bind(this))},Element.prototype.setCSS=function(){Array.from(arguments).forEach(function(e){isString(e)?this.classList.add(e):isArray(e)?this.setCSS.apply(this,e):console.warn("ERROR: cannot set something except String as an CSS-class. Skipping.")}.bind(this))},Element.prototype.setAttributes=function(e){if(isObject(e))for(var t in e)e[t]?this.setAttribute(t,e[t]):this.removeAttribute(t);else console.warn("ERROR: argument passed to setAttributes method is not an Object. Skipping.")},Element.prototype.removeAttributes=function(){Array.from(arguments).forEach(function(e){isString(e)?this.removeAttribute(e):isArray(e)?this.removeAttributes.apply(this,e):console.warn("ERROR: cannot remove attribute because given id is not a String. Skipping.")}.bind(this))},Element.prototype.setProperties=function(e){isObject(e.eventListeners)?this.setEventListeners(e.eventListeners):e.eventListeners&&console.warn("ERROR: argument passed to setEventListeners method is not an Object. Skipping"),isArray(e.classList)||isString(e.classList)?this.setCSS(e.classList):e.classList&&console.warn("ERROR: cannot set something except String or Array as an CSS-class. Skipping."),delete e.eventListeners,delete e.classList,this.setAttributes(e)},Element.prototype.appendChildren=function(){Array.from(arguments).forEach(function(e){isElement(e)?this.appendChild(e):isText(e)||isString(e)?this.innerHTML+=e:isArray(e)&&!isString(e)?this.appendChildren.apply(this,e):(console.log(e),console.warn("ERROR: cannot append something except String, Text or Element as an DOMElement. Skipping."))}.bind(this))},Element.prototype.removeChildren=function(){Array.from(arguments).forEach(function(e){isElement(e)||isText(e)?this.removeChild(e):isArray(e)&&!isString(e)?this.removeChildren.apply(this,e):console.warn("ERROR: cannot remove something except Text or Element as an DOMElement. Skipping.")}.bind(this))},Document.prototype.newElement=function(){if("string"!=typeof(arguments=Array.from(arguments))[0])return console.warn("ERROR: first argument passed to newElement method is not an String. Skipping."),null;var e=document.createElement(arguments[0]);return!(arguments=arguments.slice(1))[0]||isArray(arguments[0])||isElement(arguments[0])||isString(arguments[0])||(e.setProperties(arguments[0]),arguments=arguments.slice(1)),arguments[0]&&(isArray(arguments[0])||isElement(arguments[0])||isString(arguments[0]))&&e.appendChildren.apply(e,arguments),e},Element.prototype.newChildElement=function(){var e=document.newElement.apply(null,arguments);return e&&this.appendChild(e),e},Element.prototype.newChildElementBefore=function(){var e=document.newElement.apply(null,Array.from(arguments).splice(1,arguments.length-1));return e&&(isElement(arguments[0])?this.insertBefore(e,arguments[0]):this.appendChild(e)),e};var PolyK={};PolyK.IsSimple=function(e){var t=e.length>>1;if(t<4)return!0;for(var n=new PolyK._P,i=new PolyK._P,r=new PolyK._P,o=new PolyK._P,s=new PolyK._P,a=0;a<t;a++){n.x=e[2*a],n.y=e[2*a+1],a==t-1?(i.x=e[0],i.y=e[1]):(i.x=e[2*a+2],i.y=e[2*a+3]);for(var l=0;l<t;l++)if(!(Math.abs(a-l)<2||l==t-1&&0==a||a==t-1&&0==l||(r.x=e[2*l],r.y=e[2*l+1],l==t-1?(o.x=e[0],o.y=e[1]):(o.x=e[2*l+2],o.y=e[2*l+3]),null==PolyK._GetLineIntersection(n,i,r,o,s))))return!1}return!0},PolyK.IsConvex=function(e){if(e.length<6)return!0;for(var t=e.length-4,n=0;n<t;n+=2)if(!PolyK._convex(e[n],e[n+1],e[n+2],e[n+3],e[n+4],e[n+5]))return!1;return!!PolyK._convex(e[t],e[t+1],e[t+2],e[t+3],e[0],e[1])&&!!PolyK._convex(e[t+2],e[t+3],e[0],e[1],e[2],e[3])},PolyK.GetArea=function(e){if(e.length<6)return 0;for(var t=e.length-2,n=0,i=0;i<t;i+=2)n+=(e[i+2]-e[i])*(e[i+1]+e[i+3]);return.5*-(n+=(e[0]-e[t])*(e[t+1]+e[1]))},PolyK.GetAABB=function(e){for(var t=1/0,n=1/0,i=-t,r=-n,o=0;o<e.length;o+=2)t=Math.min(t,e[o]),i=Math.max(i,e[o]),n=Math.min(n,e[o+1]),r=Math.max(r,e[o+1]);return{x:t,y:n,width:i-t,height:r-n}},PolyK.Reverse=function(e){for(var t=[],n=e.length-2;n>=0;n-=2)t.push(e[n],e[n+1]);return t},PolyK.Triangulate=function(e){var t=e.length>>1;if(t<3)return[];for(var n=[],i=[],r=0;r<t;r++)i.push(r);r=0;for(var o=t;o>3;){var s=i[(r+0)%o],a=i[(r+1)%o],l=i[(r+2)%o],c=e[2*s],u=e[2*s+1],d=e[2*a],h=e[2*a+1],v=e[2*l],f=e[2*l+1],y=!1;if(PolyK._convex(c,u,d,h,v,f)){y=!0;for(var m=0;m<o;m++){var p=i[m];if(p!=s&&p!=a&&p!=l&&PolyK._PointInTriangle(e[2*p],e[2*p+1],c,u,d,h,v,f)){y=!1;break}}}if(y)n.push(s,a,l),i.splice((r+1)%o,1),o--,r=0;else if(r++>3*o)break}return n.push(i[0],i[1],i[2]),n},PolyK.ContainsPoint=function(e,t,n){for(var i,r=e.length>>1,o=e[2*r-3]-n,s=e[2*r-2]-t,a=e[2*r-1]-n,l=0;l<r;l++)i=s,o=a,s=e[2*l]-t,o!=(a=e[2*l+1]-n)&&(lup=a>o);var c=0;for(l=0;l<r;l++)if(i=s,o=a,s=e[2*l]-t,a=e[2*l+1]-n,!(o<0&&a<0||o>0&&a>0||i<0&&s<0)){if(o==a&&Math.min(i,s)<=0)return!0;if(o!=a){var u=i+(s-i)*-o/(a-o);if(0==u)return!0;u>0&&c++,0==o&&lup&&a>o&&c--,0==o&&!lup&&a<o&&c--,lup=a>o}}return 1==(1&c)},PolyK.Slice=function(e,t,n,i,r){if(PolyK.ContainsPoint(e,t,n)||PolyK.ContainsPoint(e,i,r))return[e.slice(0)];for(var o=new PolyK._P(t,n),s=new PolyK._P(i,r),a=[],l=[],c=0;c<e.length;c+=2)l.push(new PolyK._P(e[c],e[c+1]));for(c=0;c<l.length;c++){var u=new PolyK._P(0,0);u=PolyK._GetLineIntersection(o,s,l[c],l[(c+1)%l.length],u);var d=a[0],h=a[a.length-1];u&&(null==d||PolyK._P.dist(u,d)>1e-10)&&(null==h||PolyK._P.dist(u,h)>1e-10)&&(u.flag=!0,a.push(u),l.splice(c+1,0,u),c++)}if(a.length<2)return[e.slice(0)];a.sort(function(e,t){return PolyK._P.dist(o,e)-PolyK._P.dist(o,t)});for(var v=[],f=0;a.length>0;){l.length;var y=a[0],m=a[1],p=l.indexOf(y),_=l.indexOf(m),g=!1;if(PolyK._firstWithFlag(l,p)==_?g=!0:(y=a[1],m=a[0],p=l.indexOf(y),_=l.indexOf(m),PolyK._firstWithFlag(l,p)==_&&(g=!0)),g){f--;var x=PolyK._getPoints(l,p,_);v.push(x),l=PolyK._getPoints(l,_,p),y.flag=m.flag=!1,a.splice(0,2),0==a.length&&v.push(l)}else f++,a.reverse();if(f>1)break}var b=[];for(c=0;c<v.length;c++){for(var E=v[c],P=[],w=0;w<E.length;w++)P.push(E[w].x,E[w].y);b.push(P)}return b},PolyK.Raycast=function(e,t,n,i,r,o){var s=e.length-2,a=PolyK._tp,l=a[0],c=a[1],u=a[2],d=a[3],h=a[4];l.x=t,l.y=n,c.x=t+i,c.y=n+r,null==o&&(o={dist:0,edge:0,norm:{x:0,y:0},refl:{x:0,y:0}}),o.dist=1/0;for(var v=0;v<s;v+=2){u.x=e[v],u.y=e[v+1],d.x=e[v+2],d.y=e[v+3];PolyK._RayLineIntersection(l,c,u,d,h)&&PolyK._updateISC(i,r,l,u,d,h,v/2,o)}u.x=d.x,u.y=d.y,d.x=e[0],d.y=e[1];return PolyK._RayLineIntersection(l,c,u,d,h)&&PolyK._updateISC(i,r,l,u,d,h,e.length/2-1,o),o.dist!=1/0?o:null},PolyK.ClosestEdge=function(e,t,n,i){var r=e.length-2,o=PolyK._tp,s=o[0],a=o[2],l=o[3];o[4];s.x=t,s.y=n,null==i&&(i={dist:0,edge:0,point:{x:0,y:0},norm:{x:0,y:0}}),i.dist=1/0;for(var c=0;c<r;c+=2)a.x=e[c],a.y=e[c+1],l.x=e[c+2],l.y=e[c+3],PolyK._pointLineDist(s,a,l,c>>1,i);a.x=l.x,a.y=l.y,l.x=e[0],l.y=e[1],PolyK._pointLineDist(s,a,l,r>>1,i);var u=1/i.dist;return i.norm.x=(t-i.point.x)*u,i.norm.y=(n-i.point.y)*u,i},PolyK.Move=function(e,t,n){for(var i=[],r=PolyK.GetAABB(e),o=0;o<e.length;o++)o%2==0?i.push(Number(e[o])+t-r.x):i.push(Number(e[o])+n-r.y);return i},PolyK._pointLineDist=function(e,t,n,i,r){var o,s,a=e.x,l=e.y,c=t.x,u=t.y,d=n.x,h=n.y,v=d-c,f=h-u,y=((a-c)*v+(l-u)*f)/(v*v+f*f);y<0||c==d&&u==h?(o=c,s=u):y>1?(o=d,s=h):(o=c+y*v,s=u+y*f);var m=a-o,p=l-s,_=Math.sqrt(m*m+p*p);_<r.dist&&(r.dist=_,r.edge=i,r.point.x=o,r.point.y=s)},PolyK._updateISC=function(e,t,n,i,r,o,s,a){var l=PolyK._P.dist(n,o);if(l<a.dist){var c=1/PolyK._P.dist(i,r),u=-(r.y-i.y)*c,d=(r.x-i.x)*c,h=2*(e*u+t*d);a.dist=l,a.norm.x=u,a.norm.y=d,a.refl.x=-h*u+e,a.refl.y=-h*d+t,a.edge=s}},PolyK._getPoints=function(e,t,n){var i=e.length,r=[];n<t&&(n+=i);for(var o=t;o<=n;o++)r.push(e[o%i]);return r},PolyK._firstWithFlag=function(e,t){for(var n=e.length;;)if(t=(t+1)%n,e[t].flag)return t},PolyK._PointInTriangle=function(e,t,n,i,r,o,s,a){var l=s-n,c=a-i,u=r-n,d=o-i,h=e-n,v=t-i,f=l*l+c*c,y=l*u+c*d,m=l*h+c*v,p=u*u+d*d,_=u*h+d*v,g=1/(f*p-y*y),x=(p*m-y*_)*g,b=(f*_-y*m)*g;return x>=0&&b>=0&&x+b<1},PolyK._RayLineIntersection=function(e,t,n,i,r){var o=e.x-t.x,s=n.x-i.x,a=e.y-t.y,l=n.y-i.y,c=o*l-a*s;if(0==c)return null;var u=e.x*t.y-e.y*t.x,d=n.x*i.y-n.y*i.x,h=r,v=1/c;return h.x=(u*s-o*d)*v,h.y=(u*l-a*d)*v,PolyK._InRect(h,n,i)?a>0&&h.y>e.y||a<0&&h.y<e.y?null:o>0&&h.x>e.x||o<0&&h.x<e.x?null:h:null},PolyK._GetLineIntersection=function(e,t,n,i,r){var o=e.x-t.x,s=n.x-i.x,a=e.y-t.y,l=n.y-i.y,c=o*l-a*s;if(0==c)return null;var u=e.x*t.y-e.y*t.x,d=n.x*i.y-n.y*i.x,h=r;return h.x=(u*s-o*d)/c,h.y=(u*l-a*d)/c,PolyK._InRect(h,e,t)&&PolyK._InRect(h,n,i)?h:null},PolyK._InRect=function(e,t,n){var i=Math.min(t.x,n.x),r=Math.max(t.x,n.x),o=Math.min(t.y,n.y),s=Math.max(t.y,n.y);return i==r?o<=e.y&&e.y<=s:o==s?i<=e.x&&e.x<=r:i<=e.x+1e-10&&e.x-1e-10<=r&&o<=e.y+1e-10&&e.y-1e-10<=s},PolyK._convex=function(e,t,n,i,r,o){return(t-i)*(r-n)+(n-e)*(o-i)>=0},PolyK._P=function(e,t){this.x=e,this.y=t,this.flag=!1},PolyK._P.prototype.toString=function(){return"Point ["+this.x+", "+this.y+"]"},PolyK._P.dist=function(e,t){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)},PolyK._tp=[];for(var i=0;i<10;i++)PolyK._tp.push(new PolyK._P(0,0));var rand=Math.random;Math.random=function(e,t){return void 0==e||void 0==t?rand():e+rand()*(t+1-e)};var tests=[{name:"1",run:function(e,t){var n=new Ariphmetics(e.add(0,!0));setTimeout(function(){e.free(),new Score(e.add(0,!0),n.getScore()),t.continue()}.bind(this),3e4)}},{name:"2",run:function(e,t){var n=new Puzzle(e.add(0,!0));setTimeout(function(){e.free(),new Score(e.add(0,!0),n.getScore()),t.continue()}.bind(this),3e4)}},{name:"3А",run:function(e,t){var n=function(){if(++s>=6)return e.free(),new Score(e.add(0,!0),i.getScore()),new Score(e.add(1,!0),r.getScore()),void t.continue();r.free(),e.deactivate(o),e.activate(!o),o=!o,setTimeout(n,1e4)}.bind(this),i=new Ariphmetics(e.add(0)),r=new Puzzle(e.add(1)),o=0,s=0;e.activate(o),e.deactivate(!o),setTimeout(n,1e4)}},{name:"3Б",run:B3.bind(null,3,null,!1)},{name:"3B",run:B3.bind(null,6,null,!1)},{name:"3Г",run:B3.bind(null,10,null,!1)},{name:"4",run:function(e,t){var n=new Concentration(e.add(0,!0),15e3);setTimeout(function(){n.free(),e.free(),B3(3,null,!1,e,t)}.bind(this),15e3)}},{name:"5А",run:B3.bind(null,3,"WAV/siren.wav",!0)},{name:"5Б",run:B3.bind(null,3,null,!1)},{name:"5В",run:function(e,t){var n=75,i=document.body.newChildElement("audio",{eventListeners:{loadeddata:function(){var r=setInterval(function(){if(n<=0)return clearInterval(r),void document.body.removeChild(i);n--,i.pause(),i.currentTime=0,i.play()},1e3);B3(3,null,!1,e,t)}.bind(this)}});i.setAttribute("SRC","WAV/clap.wav")}},{name:"6",run:B3.bind(null,3,null,!1)}],state=new State(document.body,tests);