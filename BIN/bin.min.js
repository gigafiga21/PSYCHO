function isFunction(t){return t instanceof Function}function isArray(t){return t instanceof Array}function isObject(t){return t instanceof Object}function isElement(t){return t instanceof Element}function isText(t){return t instanceof Text}function isString(t){return"string"==typeof t}function Puzzle(t){function e(){var t=function(){for(var t=Math.random(3,6),e=[],n=0,i=0;i<t;i++)n+=Math.floor(Math.random(270/t,360/t)),e.push(125+75*Math.round(Math.cos(n*Math.PI/180))),e.push(150+75*Math.round(Math.sin(n*Math.PI/180)));return e}(),e=document.createElementNS("http://www.w3.org/2000/svg","polygon");e.classList.add("puzzle__frame"),e.setAttribute("points",t),o.canvas.appendChild(e);var n=function(t){for(var e=[],n=0;n<3;n++){var i,r=PolyK.GetAABB(t),o=r.x+r.width/2,s=r.y+r.height/2,a={},l={};i=n%2==0?Math.floor(Math.random(0,Math.PI/9*4)):Math.floor(Math.random(Math.PI/9*5,Math.PI/18*17)),a={x:r.x+r.width+10,y:Math.tan(i)*(r.x+10+r.width-o)+s},l={x:r.x-10,y:Math.tan(i)*(r.x-10-o)+s};var c=PolyK.Slice(t,a.x,a.y,l.x,l.y);2==c.length&&(e.push(c[0]),t=c[1])}return e.push(t),e}(t).sort(function(){return Math.random()-.5}),i={x:205,y:75,xMax:0};a=n.length;for(var l=0;l<n.length;l++){var c=PolyK.GetAABB(n[l]),u={x0:c.x,y0:c.y,id:l};c.height<230-i.y?(n[l]=PolyK.Move(n[l],i.x,i.y),u.x=i.x,u.y=i.y,i.y=i.y+c.height+5,c.width+i.x>i.xMax&&(i.xMax=c.width+i.x)):(i.y=80+c.height,i.x=i.xMax+5,i.xMax=i.x+c.width,n[l]=PolyK.Move(n[l],i.x,75),u.x=i.x,u.y=75),s.push(u);var d=document.createElementNS("http://www.w3.org/2000/svg","polygon");d.classList.add("puzzle__puzzle"),d.setAttribute("points",n[l]),d.setAttribute("index",l),d.addEventListener("mousedown",r),o.canvas.appendChild(d)}o.canvas.style.width=i.xMax+50+"px"}var n=function(t){var e=l.getAttribute("points").split(","),n=PolyK.GetAABB(e),i=o.canvas.getBoundingClientRect(),r=t.pageX-i.left,a=t.pageY-i.top,c=Number(l.getAttribute("index")),u=o.canvas.clientWidth;PolyK.ContainsPoint([0,0,u,0,u,300,0,300],n.x,n.y)&&PolyK.ContainsPoint([0,0,u,0,u,300,0,300],n.x+n.width,n.y+n.height)?(e=PolyK.Move(e,r-s[c].cursorX,a-s[c].cursorY),l.setAttribute("points",e)):document.body.dispatchEvent(new Event("mouseup"))}.bind(this),i=function(t){var u=Number(l.getAttribute("index")),d=l.getAttribute("points").split(","),h=PolyK.GetAABB(d);Math.abs(s[u].x0-h.x)<11&&Math.abs(s[u].y0-h.y)<11?(l.setAttribute("points",PolyK.Move(d,s[u].x0,s[u].y0)),l.removeEventListener("mousedown",r),0==--a&&(o.canvas.innerHTML="",s=[],c++,e())):l.setAttribute("points",PolyK.Move(l.getAttribute("points").split(","),s[u].x,s[u].y)),document.body.removeEventListener("mousemove",n),document.body.removeEventListener("mouseup",i),l=null}.bind(this),r=function(t){(l=t.target.cloneNode(!0)).addEventListener("mousedown",r),o.canvas.removeChild(t.target),o.canvas.appendChild(l);var e=PolyK.GetAABB(l.getAttribute("points").split(",")),a=o.canvas.getBoundingClientRect(),c=Number(l.getAttribute("index"));document.body.addEventListener("mousemove",n),document.body.addEventListener("mouseup",i),s[c].cursorX=t.pageX-a.left-e.x,s[c].cursorY=t.pageY-a.top-e.y}.bind(this);this.free=function(){document.body.dispatchEvent(new Event("mouseup"))},this.getScore=function(){return c};var o={canvas:null},s=[],a=0,l=null,c=0;o.canvas=document.createElementNS("http://www.w3.org/2000/svg","svg"),o.canvas.classList.add("puzzle__canvas"),t.appendChild(o.canvas),e()}function Ariphmetics(t){function e(){var t=function(){var t={a:null,operation:["+","-","/","*"][Math.floor(Math.random(0,3))],b:null,result:null};switch(t.operation){case"+":t.result=Math.floor(Math.random(1,99)),t.a=Math.floor(Math.random(1,t.result)),t.b=t.result-t.a;break;case"-":t.result=Math.floor(Math.random(1,70)),t.a=Math.floor(Math.random(t.result,99)),t.b=t.a-t.result;break;case"*":t.a=Math.floor(Math.random(2,49)),t.b=Math.floor(Math.random(2,100/t.a)),t.result=t.a*t.b;break;case"/":t.result=Math.floor(Math.random(2,49)),t.b=Math.floor(Math.random(2,100/t.result)),t.a=t.result*t.b}return t}(),r=function(t){for(var e=[],n=1;n<99;n++)n!=t&&e.push(n);return e.sort(function(){return Math.random()-.5}),e.slice(0,2)}(t.result),o=Math.floor(Math.random(0,r.length));r.splice(o,0,t.result),n.equotation.innerHTML=t.a+" "+t.operation+" "+t.b+" =";for(var s=0;s<r.length;s++){var a=n.answers.newChildElement("button",{classList:"ariphmetics__checkbox"});a.addEventListener("click",function(t){"RIGHT"==t.target.getAttribute("NAME")&&i++;n.answers.innerHTML="",n.equotation.innerHTML="",e()}.bind(this)),n.answers.newChildElement("span",{},""+r[s]),n.answers.newChildElement("br"),r[s]==t.result&&a.setAttribute("NAME","RIGHT")}}this.getScore=function(){return i};var n={container:null,equotation:null,answers:null},i=0;n.container=t.newChildElement("div",{classList:"ariphmetics__container"}),n.equotation=n.container.newChildElement("div",{classList:"ariphmetics__equotation"}),n.answers=n.container.newChildElement("div"),e()}function Concentration(t,e){function n(){(s.point||o)&&(s.point?(s.field.removeChild(s.point),s.point=null):o&&(o=!1),r=setTimeout(function(){r=null,s.point=s.field.newChildElement("div",{classList:"concentration__point"}),s.point.style.left=Math.floor(Math.random(5,565))+"px",s.point.style.top=Math.floor(Math.random(5,260))+"px"},Math.floor(Math.random(0,e/4))))}this.free=function(){null!=r&&(clearTimeout(r),document.body.removeEventListener("keyup",i))};var i=function(t){13!=t.which&&13!=t.keyCode||s.button.dispatchEvent(new Event("click"))}.bind(this),r=null,o=!0,s={container:null,button:null,field:null,point:null};s.container=t.newChildElement("div",{classList:"concentration__container"}),s.field=s.container.newChildElement("div",{classList:"concentration__field"}),n(),s.button=s.container.newChildElement("div",{classList:"concentration__button"}),s.button.innerText="<Enter>",s.button.addEventListener("click",n.bind(this)),document.body.addEventListener("keyup",i)}function Breaker(t){var e={EN:{rest:"Teke a rest:"},RU:{rest:"Отдыхайте:"}};this.toggle=function(){i?n.container.removeCSS("breaker__container--hidden"):n.container.setCSS("breaker__container--hidden"),i=!i},this.setTime=function(t){n.time.innerHTML=t+"s"};var n={container:null,text:null,time:null},i=!0;n.container=t.newChildElement("div",{classList:["breaker__container","breaker__container--hidden"]}),n.text=n.container.newChildElement("span",{classList:"breaker__text"},e[translations.current].rest),n.time=n.container.newChildElement("span",{classList:"breaker__time"}),translations.addEventListener(function(t){n.text.innerHTML=e[translations.current].rest}.bind(this))}function Score(t,e){var n={EN:{score:"Score:"},RU:{score:"Результат:"}},i={container:null,header:null,score:null};i.container=t.newChildElement("div",{classList:"score__container"}),i.header=i.container.newChildElement("span",{classList:"score__header"},n[translations.current].score),i.score=i.container.newChildElement("span",{classList:"score__result"},""+e),translations.addEventListener(function(t){i.header.innerHTML=n[translations.current].score}.bind(this))}function State(t,e){function n(){o++,s.free(),r.current.innerHTML="#"+e[o].name,r.next.disabled=!0,e[o].run(s,this)}var i={EN:{again:"Repeat",next:"Next >",start:"Start testing"},RU:{again:"Ещё раз",next:"Следующий >",start:"Начать тестирование"}};this.continue=function(){o==e.length-1&&(r.next.innerHTML=i[translations.current].again,o=-1),r.next.disabled=!1};var r={container:null,current:null,next:null,frame:null},o=-1,s=new Test(document.body);e.splice(0,0,{name:"0",run:function(){s.add(0).newChildElement("button",{classList:["state__button","state__start"],eventListeners:{click:n.bind(this)}},i[translations.current].start)}.bind(this)}),r.container=t.newChildElement("div",{classList:"state__container"}),r.current=r.container.newChildElement("span",{classList:"state__name"},""),r.next=r.container.newChildElement("button",{classList:"state__button",eventListeners:{click:n.bind(this)}},i[translations.current].next),translations.addEventListener(function(t){var e=document.querySelector(".state__start");e&&(e.innerHTML=i[translations.current].start),r.next.innerHTML=-1!=o||e?i[translations.current].next:i[translations.current].again}.bind(this)),n()}function Test(t){var e=function(){if(n){var t=r.container.rows[0].cells[i],e=(document.body.clientWidth-t.clientWidth)/2;r.container.getBoundingClientRect().left,t.getBoundingClientRect().left;r.container.style.left=e-t.offsetLeft+"px"}}.bind(this);this.deactivate=function(t){t=Number(t),r.container.rows[0].cells[t].appendChild(r.inactive.cloneNode(!0)),r.container.rows[0].cells[t].setCSS("test__inactive")},this.activate=function(t){i=Number(t),t=Number(t),e(),r.container.rows[0].cells[t].removeCSS("test__inactive");var n=r.container.rows[0].cells[t].getElementsByClassName("test__inactive_cover")[0];n&&r.container.rows[0].cells[t].removeChild(n)},this.add=function(t,e){var i=r.container.rows[0].insertCell(t);return i.setAttribute("index",t),i.setCSS("test__cell"),e&&(n=!1),i},this.free=function(){i=0,n=!0,r.container.style.left=null,r.container.rows[0].innerHTML=""};var n=!0,i=0,r={container:null,inactive:null};r.container=t.newChildElement("table",{classList:"test__container"},document.newElement("tr")),r.container.setEventListeners({resize:e}),r.inactive=document.newElement("div",{classList:"test__inactive_cover"})}function B3(t,e,n,i,r){var o=function(){i.activate(u),setTimeout(s,1e4)}.bind(this),s=function(){if(c.free(),++d>=6)return e&&document.body.removeChild(h),i.free(),new Score(i.add(0,!0),a.getScore()),new Score(i.add(1,!0),c.getScore()),void r.continue();i.deactivate(u),u=0==u?2:0,i.activate(1),l.toggle(),l.setTime(t),e&&h.play();var s=t,v=setInterval(function(){if(--s<=0)return null==e||n||h.play(),clearInterval(v),l.toggle(),i.deactivate(1),void o();e&&n&&(h.pause(),h.currentTime=0,h.play()),l.setTime(s)}.bind(this),1e3)}.bind(this),a=new Ariphmetics(i.add(0)),l=new Breaker(i.add(1)),c=new Puzzle(i.add(2)),u=0,d=0,h=null;e&&(h=document.body.newChildElement("audio",{SRC:e})),i.activate(0),i.deactivate(1),i.deactivate(2),setTimeout(s,1e4)}Element.prototype.setEventListeners=function(t){if(t&&isObject(t)){this.__events__=this.__events__||{};for(var e in t)isArray(t[e])||(t[e]=[t[e]]),this.__events__[e]=this.__events__[e]||[],t[e].forEach(function(t){if(isFunction(t)){if("resize"==e&&"IFRAME"!=this.tagName&&this.__events__.resize&&!this.__events__.resize.length)this.__resizer__=this.newChildElementBefore(this.children[0],"iframe",{style:"WIDTH:100%;HEIGHT:100%;POSITION:ABSOLUTE;OPACITY:0;Z-INDEX:-1000",name:"BASIS__RESIZER"}),this.__resizer__.contentWindow.onresize=function(){this.dispatchEvent(new Event("resize"))}.bind(this);else if("startloading"==e&&"IFRAME"==this.tagName&&this.__events__.startloading&&!this.__events__.startloading.length)var n=setInterval(function(){try{if("about:blank"==this.src)(t=new Event("startloading")).error="src",clearInterval(n),this.dispatchEvent(t);else if("about:blank"!=this.contentWindow.location.href){var t=new Event("startloading");clearInterval(n),this.dispatchEvent(t)}}catch(e){(t=new Event("startloading")).error="origin",clearInterval(n),this.dispatchEvent(t)}}.bind(this),10);this.__events__[e].push(t),this.addEventListener(e,t)}else console.warn('ERROR: cannot set something except Function as an event listener to event, called "'+e+'". Skipping.')}.bind(this))}else console.warn("ERROR: argument passed to setEventListeners method is not an Object. Skipping.")},Element.prototype.removeEventListeners=function(t){if(t&&isObject(t)){this.__events__=this.__events__||{};for(var e in t)isArray(t[e])||(t[e]=[t[e]]),this.__events__[e]=this.__events__[e]||[],t[e].forEach(function(t){if(isFunction(t)){var n=this.__events__[e].indexOf(t);-1!=n&&(this.__events__[e].splice(n,1),"startloading"!=e||this.__events__[e].length||this.removeChildren(this.__resizer__)),this.removeEventListener(e,t)}else console.warn('ERROR: cannot remove something except Function as an event listener to event, called "'+e+'". Skipping.')}.bind(this))}else console.warn("ERROR: argument passed to setEventListeners method is not an Object. Skipping.")},Element.prototype.cloneElement=function(t){var e;return t.deep,e=this.cloneNode(!0),t.listeners&&(e.__events__=this.__events__,e.setEventListeners(e.__events__)),e},Element.prototype.removeCSS=function(){Array.from(arguments).forEach(function(t){isString(t)?this.classList.remove(t):isArray(t)?this.setCSS.apply(this,t):console.warn("ERROR: cannot remove something except String as an CSS-class. Skipping.")}.bind(this))},Element.prototype.setCSS=function(){Array.from(arguments).forEach(function(t){isString(t)?this.classList.add(t):isArray(t)?this.setCSS.apply(this,t):console.warn("ERROR: cannot set something except String as an CSS-class. Skipping.")}.bind(this))},Element.prototype.setAttributes=function(t){if(isObject(t))for(var e in t)t[e]?this.setAttribute(e,t[e]):this.removeAttribute(e);else console.warn("ERROR: argument passed to setAttributes method is not an Object. Skipping.")},Element.prototype.removeAttributes=function(){Array.from(arguments).forEach(function(t){isString(t)?this.removeAttribute(t):isArray(t)?this.removeAttributes.apply(this,t):console.warn("ERROR: cannot remove attribute because given id is not a String. Skipping.")}.bind(this))},Element.prototype.setProperties=function(t){isObject(t.eventListeners)?this.setEventListeners(t.eventListeners):t.eventListeners&&console.warn("ERROR: argument passed to setEventListeners method is not an Object. Skipping"),isArray(t.classList)||isString(t.classList)?this.setCSS(t.classList):t.classList&&console.warn("ERROR: cannot set something except String or Array as an CSS-class. Skipping."),delete t.eventListeners,delete t.classList,this.setAttributes(t)},Element.prototype.appendChildren=function(){Array.from(arguments).forEach(function(t){isElement(t)?this.appendChild(t):isText(t)||isString(t)?this.innerHTML+=t:isArray(t)&&!isString(t)?this.appendChildren.apply(this,t):(console.log(t),console.warn("ERROR: cannot append something except String, Text or Element as an DOMElement. Skipping."))}.bind(this))},Element.prototype.removeChildren=function(){Array.from(arguments).forEach(function(t){isElement(t)||isText(t)?this.removeChild(t):isArray(t)&&!isString(t)?this.removeChildren.apply(this,t):console.warn("ERROR: cannot remove something except Text or Element as an DOMElement. Skipping.")}.bind(this))},Document.prototype.newElement=function(){if("string"!=typeof(arguments=Array.from(arguments))[0])return console.warn("ERROR: first argument passed to newElement method is not an String. Skipping."),null;var t=document.createElement(arguments[0]);return!(arguments=arguments.slice(1))[0]||isArray(arguments[0])||isElement(arguments[0])||isString(arguments[0])||(t.setProperties(arguments[0]),arguments=arguments.slice(1)),arguments[0]&&(isArray(arguments[0])||isElement(arguments[0])||isString(arguments[0]))&&t.appendChildren.apply(t,arguments),t},Element.prototype.newChildElement=function(){var t=document.newElement.apply(null,arguments);return t&&this.appendChild(t),t},Element.prototype.newChildElementBefore=function(){var t=document.newElement.apply(null,Array.from(arguments).splice(1,arguments.length-1));return t&&(isElement(arguments[0])?this.insertBefore(t,arguments[0]):this.appendChild(t)),t};var PolyK={};PolyK.IsSimple=function(t){var e=t.length>>1;if(e<4)return!0;for(var n=new PolyK._P,i=new PolyK._P,r=new PolyK._P,o=new PolyK._P,s=new PolyK._P,a=0;a<e;a++){n.x=t[2*a],n.y=t[2*a+1],a==e-1?(i.x=t[0],i.y=t[1]):(i.x=t[2*a+2],i.y=t[2*a+3]);for(var l=0;l<e;l++)if(!(Math.abs(a-l)<2||l==e-1&&0==a||a==e-1&&0==l||(r.x=t[2*l],r.y=t[2*l+1],l==e-1?(o.x=t[0],o.y=t[1]):(o.x=t[2*l+2],o.y=t[2*l+3]),null==PolyK._GetLineIntersection(n,i,r,o,s))))return!1}return!0},PolyK.IsConvex=function(t){if(t.length<6)return!0;for(var e=t.length-4,n=0;n<e;n+=2)if(!PolyK._convex(t[n],t[n+1],t[n+2],t[n+3],t[n+4],t[n+5]))return!1;return!!PolyK._convex(t[e],t[e+1],t[e+2],t[e+3],t[0],t[1])&&!!PolyK._convex(t[e+2],t[e+3],t[0],t[1],t[2],t[3])},PolyK.GetArea=function(t){if(t.length<6)return 0;for(var e=t.length-2,n=0,i=0;i<e;i+=2)n+=(t[i+2]-t[i])*(t[i+1]+t[i+3]);return.5*-(n+=(t[0]-t[e])*(t[e+1]+t[1]))},PolyK.GetAABB=function(t){for(var e=1/0,n=1/0,i=-e,r=-n,o=0;o<t.length;o+=2)e=Math.min(e,t[o]),i=Math.max(i,t[o]),n=Math.min(n,t[o+1]),r=Math.max(r,t[o+1]);return{x:e,y:n,width:i-e,height:r-n}},PolyK.Reverse=function(t){for(var e=[],n=t.length-2;n>=0;n-=2)e.push(t[n],t[n+1]);return e},PolyK.Triangulate=function(t){var e=t.length>>1;if(e<3)return[];for(var n=[],i=[],r=0;r<e;r++)i.push(r);r=0;for(var o=e;o>3;){var s=i[(r+0)%o],a=i[(r+1)%o],l=i[(r+2)%o],c=t[2*s],u=t[2*s+1],d=t[2*a],h=t[2*a+1],v=t[2*l],f=t[2*l+1],y=!1;if(PolyK._convex(c,u,d,h,v,f)){y=!0;for(var m=0;m<o;m++){var p=i[m];if(p!=s&&p!=a&&p!=l&&PolyK._PointInTriangle(t[2*p],t[2*p+1],c,u,d,h,v,f)){y=!1;break}}}if(y)n.push(s,a,l),i.splice((r+1)%o,1),o--,r=0;else if(r++>3*o)break}return n.push(i[0],i[1],i[2]),n},PolyK.ContainsPoint=function(t,e,n){for(var i,r=t.length>>1,o=t[2*r-3]-n,s=t[2*r-2]-e,a=t[2*r-1]-n,l=0;l<r;l++)i=s,o=a,s=t[2*l]-e,o!=(a=t[2*l+1]-n)&&(lup=a>o);var c=0;for(l=0;l<r;l++)if(i=s,o=a,s=t[2*l]-e,a=t[2*l+1]-n,!(o<0&&a<0||o>0&&a>0||i<0&&s<0)){if(o==a&&Math.min(i,s)<=0)return!0;if(o!=a){var u=i+(s-i)*-o/(a-o);if(0==u)return!0;u>0&&c++,0==o&&lup&&a>o&&c--,0==o&&!lup&&a<o&&c--,lup=a>o}}return 1==(1&c)},PolyK.Slice=function(t,e,n,i,r){if(PolyK.ContainsPoint(t,e,n)||PolyK.ContainsPoint(t,i,r))return[t.slice(0)];for(var o=new PolyK._P(e,n),s=new PolyK._P(i,r),a=[],l=[],c=0;c<t.length;c+=2)l.push(new PolyK._P(t[c],t[c+1]));for(c=0;c<l.length;c++){var u=new PolyK._P(0,0);u=PolyK._GetLineIntersection(o,s,l[c],l[(c+1)%l.length],u);var d=a[0],h=a[a.length-1];u&&(null==d||PolyK._P.dist(u,d)>1e-10)&&(null==h||PolyK._P.dist(u,h)>1e-10)&&(u.flag=!0,a.push(u),l.splice(c+1,0,u),c++)}if(a.length<2)return[t.slice(0)];a.sort(function(t,e){return PolyK._P.dist(o,t)-PolyK._P.dist(o,e)});for(var v=[],f=0;a.length>0;){l.length;var y=a[0],m=a[1],p=l.indexOf(y),_=l.indexOf(m),g=!1;if(PolyK._firstWithFlag(l,p)==_?g=!0:(y=a[1],m=a[0],p=l.indexOf(y),_=l.indexOf(m),PolyK._firstWithFlag(l,p)==_&&(g=!0)),g){f--;var x=PolyK._getPoints(l,p,_);v.push(x),l=PolyK._getPoints(l,_,p),y.flag=m.flag=!1,a.splice(0,2),0==a.length&&v.push(l)}else f++,a.reverse();if(f>1)break}var b=[];for(c=0;c<v.length;c++){for(var E=v[c],w=[],P=0;P<E.length;P++)w.push(E[P].x,E[P].y);b.push(w)}return b},PolyK.Raycast=function(t,e,n,i,r,o){var s=t.length-2,a=PolyK._tp,l=a[0],c=a[1],u=a[2],d=a[3],h=a[4];l.x=e,l.y=n,c.x=e+i,c.y=n+r,null==o&&(o={dist:0,edge:0,norm:{x:0,y:0},refl:{x:0,y:0}}),o.dist=1/0;for(var v=0;v<s;v+=2){u.x=t[v],u.y=t[v+1],d.x=t[v+2],d.y=t[v+3];PolyK._RayLineIntersection(l,c,u,d,h)&&PolyK._updateISC(i,r,l,u,d,h,v/2,o)}u.x=d.x,u.y=d.y,d.x=t[0],d.y=t[1];return PolyK._RayLineIntersection(l,c,u,d,h)&&PolyK._updateISC(i,r,l,u,d,h,t.length/2-1,o),o.dist!=1/0?o:null},PolyK.ClosestEdge=function(t,e,n,i){var r=t.length-2,o=PolyK._tp,s=o[0],a=o[2],l=o[3];o[4];s.x=e,s.y=n,null==i&&(i={dist:0,edge:0,point:{x:0,y:0},norm:{x:0,y:0}}),i.dist=1/0;for(var c=0;c<r;c+=2)a.x=t[c],a.y=t[c+1],l.x=t[c+2],l.y=t[c+3],PolyK._pointLineDist(s,a,l,c>>1,i);a.x=l.x,a.y=l.y,l.x=t[0],l.y=t[1],PolyK._pointLineDist(s,a,l,r>>1,i);var u=1/i.dist;return i.norm.x=(e-i.point.x)*u,i.norm.y=(n-i.point.y)*u,i},PolyK.Move=function(t,e,n){for(var i=[],r=PolyK.GetAABB(t),o=0;o<t.length;o++)o%2==0?i.push(Number(t[o])+e-r.x):i.push(Number(t[o])+n-r.y);return i},PolyK._pointLineDist=function(t,e,n,i,r){var o,s,a=t.x,l=t.y,c=e.x,u=e.y,d=n.x,h=n.y,v=d-c,f=h-u,y=((a-c)*v+(l-u)*f)/(v*v+f*f);y<0||c==d&&u==h?(o=c,s=u):y>1?(o=d,s=h):(o=c+y*v,s=u+y*f);var m=a-o,p=l-s,_=Math.sqrt(m*m+p*p);_<r.dist&&(r.dist=_,r.edge=i,r.point.x=o,r.point.y=s)},PolyK._updateISC=function(t,e,n,i,r,o,s,a){var l=PolyK._P.dist(n,o);if(l<a.dist){var c=1/PolyK._P.dist(i,r),u=-(r.y-i.y)*c,d=(r.x-i.x)*c,h=2*(t*u+e*d);a.dist=l,a.norm.x=u,a.norm.y=d,a.refl.x=-h*u+t,a.refl.y=-h*d+e,a.edge=s}},PolyK._getPoints=function(t,e,n){var i=t.length,r=[];n<e&&(n+=i);for(var o=e;o<=n;o++)r.push(t[o%i]);return r},PolyK._firstWithFlag=function(t,e){for(var n=t.length;;)if(e=(e+1)%n,t[e].flag)return e},PolyK._PointInTriangle=function(t,e,n,i,r,o,s,a){var l=s-n,c=a-i,u=r-n,d=o-i,h=t-n,v=e-i,f=l*l+c*c,y=l*u+c*d,m=l*h+c*v,p=u*u+d*d,_=u*h+d*v,g=1/(f*p-y*y),x=(p*m-y*_)*g,b=(f*_-y*m)*g;return x>=0&&b>=0&&x+b<1},PolyK._RayLineIntersection=function(t,e,n,i,r){var o=t.x-e.x,s=n.x-i.x,a=t.y-e.y,l=n.y-i.y,c=o*l-a*s;if(0==c)return null;var u=t.x*e.y-t.y*e.x,d=n.x*i.y-n.y*i.x,h=r,v=1/c;return h.x=(u*s-o*d)*v,h.y=(u*l-a*d)*v,PolyK._InRect(h,n,i)?a>0&&h.y>t.y||a<0&&h.y<t.y?null:o>0&&h.x>t.x||o<0&&h.x<t.x?null:h:null},PolyK._GetLineIntersection=function(t,e,n,i,r){var o=t.x-e.x,s=n.x-i.x,a=t.y-e.y,l=n.y-i.y,c=o*l-a*s;if(0==c)return null;var u=t.x*e.y-t.y*e.x,d=n.x*i.y-n.y*i.x,h=r;return h.x=(u*s-o*d)/c,h.y=(u*l-a*d)/c,PolyK._InRect(h,t,e)&&PolyK._InRect(h,n,i)?h:null},PolyK._InRect=function(t,e,n){var i=Math.min(e.x,n.x),r=Math.max(e.x,n.x),o=Math.min(e.y,n.y),s=Math.max(e.y,n.y);return i==r?o<=t.y&&t.y<=s:o==s?i<=t.x&&t.x<=r:i<=t.x+1e-10&&t.x-1e-10<=r&&o<=t.y+1e-10&&t.y-1e-10<=s},PolyK._convex=function(t,e,n,i,r,o){return(e-i)*(r-n)+(n-t)*(o-i)>=0},PolyK._P=function(t,e){this.x=t,this.y=e,this.flag=!1},PolyK._P.prototype.toString=function(){return"Point ["+this.x+", "+this.y+"]"},PolyK._P.dist=function(t,e){var n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)},PolyK._tp=[];for(var i=0;i<10;i++)PolyK._tp.push(new PolyK._P(0,0));var rand=Math.random;Math.random=function(t,e){return void 0==t||void 0==e?rand():t+rand()*(e+1-t)};var translations=new function(){function t(t){var n=i.container.querySelector("[name='"+t+"']");if(n){var r=i.container.querySelector(".translations__button--active");r&&r.classList.remove("translations__button--active"),n.classList.add("translations__button--active"),e.forEach(function(e){e(t)})}}this.addEventListener=function(t){e.push(t)};var e=[],n=[];Object.defineProperty(this,"languages",{set:function(e){i.container.innerHTML="",(n=e).forEach(function(e){var n=i.container.newChildElement("button",{classList:"translations__button",name:e},e);n.addEventListener("click",t.bind(this,e)),i.buttons.push(n)}.bind(this)),t(n[0])}.bind(this)}),Object.defineProperty(this,"current",{get:function(){var t=i.container.querySelector(".translations__button--active");return t?t.name:null}.bind(this)});var i={container:null,buttons:[]};i.container=document.body.newChildElement("div",{classList:"translations__container"})},tests=[{name:"1",run:function(t,e){var n=new Ariphmetics(t.add(0,!0));setTimeout(function(){t.free(),new Score(t.add(0,!0),n.getScore()),e.continue()}.bind(this),3e4)}},{name:"2",run:function(t,e){var n=new Puzzle(t.add(0,!0));setTimeout(function(){t.free(),new Score(t.add(0,!0),n.getScore()),e.continue()}.bind(this),3e4)}},{name:"3A",run:function(t,e){var n=function(){if(++s>=6)return t.free(),new Score(t.add(0,!0),i.getScore()),new Score(t.add(1,!0),r.getScore()),void e.continue();r.free(),t.deactivate(o),t.activate(!o),o=!o,setTimeout(n,1e4)}.bind(this),i=new Ariphmetics(t.add(0)),r=new Puzzle(t.add(1)),o=0,s=0;t.activate(o),t.deactivate(!o),setTimeout(n,1e4)}},{name:"3B",run:B3.bind(null,3,null,!1)},{name:"3C",run:B3.bind(null,6,null,!1)},{name:"3D",run:B3.bind(null,10,null,!1)},{name:"4",run:function(t,e){var n=new Concentration(t.add(0,!0),15e3);setTimeout(function(){n.free(),t.free(),B3(3,null,!1,t,e)}.bind(this),15e3)}},{name:"5A",run:B3.bind(null,3,"WAV/siren.wav",!0)},{name:"5B",run:B3.bind(null,3,"WAV/clap.wav",!1)},{name:"5C",run:function(t,e){var n=75,i=document.body.newChildElement("audio",{eventListeners:{loadeddata:function(){var r=setInterval(function(){if(n<=0)return clearInterval(r),void document.body.removeChild(i);n--,i.pause(),i.currentTime=0,i.play()},1e3);B3(3,null,!1,t,e)}.bind(this)}});i.setAttribute("SRC","WAV/clap.wav")}},{name:"6",run:B3.bind(null,3,null,!1)}];translations.languages=["EN","RU"];var state=new State(document.body,tests);
